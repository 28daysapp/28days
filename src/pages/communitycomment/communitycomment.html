<!--
  Generated template for the CommunitycommentPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

	<ion-navbar>
		<ion-title>커뮤니티</ion-title>
	</ion-navbar>

</ion-header>


<ion-content padding class="CommunityfixPage">

	<ul>
		<span class="posttitle">{{ post.posttitle }}</span>
		<br>
		<div class="username">
			<span class="anonymity" *ngIf="changeAnonymity(post)">익명</span>
			<!-- communitywrite에서 익명 체크 시 username대신 익명으로 보임 -->
			<span class="anonymity" *ngIf="!changeAnonymity(post)">{{ post.username }}</span>

			<!-- 프로필사진 보이게하려다 포기
			<ion-item *ngFor="let user of userList">
				<div class="list">
				  <div class="profilephoto">
					<img src="{{this.user.photoURL}}">
					<span class="anonymity" *ngIf="!changeAnonymity(post)">{{ post.username }}</span>
				  </div>
				</div>
			</ion-item>
			-->

			<span class="button" style="float:right" *ngIf="reportuser(post)">
				<!-- 현재 계정 이외의 게시물에서만 보임 -->
				<button (click)="reportpost(post)">신고</button>
			</span>
			<span class="button" style="float:right" *ngIf="usercorrect(post)">
				<!-- 현재 계정의 게시물만 보임 -->
				<button (click)="updatepost(post)">수정</button>
				<button (click)="postdelete(post)">삭제</button>
			</span>
		</div>
		<div class="posttext" style="width:100%">{{ post.text }}</div>
		<br>
		<div class="picture" *ngIf="post.url">
			<!-- 업로드한 사진을 작게 보여줌 -->
			<button (click)="imgexpansion(post)">
				<!-- 사진 클릭시 사진을 확대한페이지로 이동 -->
				<img src="{{ post.url }}">
			</button>
		</div>
		<div class="posttag1">
			<button (click)="searchtag(post.tag1)" *ngIf="tagcheck(post.tag1)">#{{ post.tag1 }}</button>
			<span class="time" style="float:right">{{ post.timestamp | date:'MM.dd a hh:mm' }}</span>
		</div>
		<table class="co-li" style="width:100%">
			<!-- 좋아요와 댓글 갯수 table -->
			<td align="center" style="width: 50%">
				<tr class="comment-like">
					<button class="like" (click)="like(post)">
						<img src="{{ post.likesrc }}">
						<span>{{ post.like }}</span>
					</button>
				</tr>
			</td>
			<td align="center" style="width: 50%">
				<tr class="comment-like">
					<button class="like">
						<img src="assets/comment.png">
						<span>{{ post.comment }}</span>
					</button>
				</tr>
			</td>
		</table>

		<li *ngFor="let comment of comments">
			<!-- 댓글 내가 안함 -->
			<div class="comment">
				<div class="comment-line1">{{ comment.username }}
					<span class="time" style="float:right">{{ comment.timestamp | date:'MM.dd a hh:mm' }}</span>
				</div>
				<p class="text">{{ comment.text }}</p>
				<span class="button" *ngIf="usercorrect_cmt(comment)">
					<button (click)="updatebutton(comment)">수정</button>
					<button (click)="deletecomment(comment)">삭제</button>
				</span>
				<span class="button" *ngIf="reportuser_cmt(comment)">
					<button (click)="reportcomment(comment)">신고</button>
				</span>
				<div *ngIf="comment.updatecomment">

					<div class="subcomment">
						<form [formGroup]="updateForm" class="footerform">
							<input formControlName="txt" type="text">
							<button (click)="updatecomment(comment)" style="float:right">
								게시
							</button>
						</form>
					</div>
				</div>

				<!-- 뭔지 모름
		<li *ngFor="let comment of comments">
			<div class="comment">
				<div class="bubble">
					<p class="name">{{ comment.username }}</p>
					<p class="text">{{ comment.text }}</p>
				</div>
			<span *ngIf="usercorrect_cmt(comment)">
				<button  (click)="updatebutton(comment)">수정</button>
				<button (click)="deletecomment(comment)">삭제</button>
			</span>
			<span *ngIf="reportuser_cmt(comment)">
				<button (click)="reportcomment(comment)">신고</button>
			</span>
				<div *ngIf="comment.updatecomment">
					
					<div class="subcomment">
							<form [formGroup]="updateForm" class="commentform">
									<input formControlName="txt" type="text">
											<button (click)="updatecomment(comment)">
												<img src="assets/send.png">
											</button>
									
								</form>
					</div>
				</div>
			
				<div class="btn">
					<button (click)="showsubcomment(comment)">답글 달기<span *ngIf="comment.subcommentnum != 0"> - 답글 {{ comment.subcommentnum }}개</span></button>
				</div>
			</div>
			<div *ngIf="comment.showsubcomment">
				<ul class="subcommentlist" *ngIf="comment.subcommentnum != 0">
					<li *ngFor="let subcomment of subcomments">
						<div class="subcomment">
							<div class="bubble">
								<p class="name">{{ subcomment.username }}</p>
								<p class="text">{{ subcomment.text }}</p>
							</div>
						</div>
					</li>
				</ul>
				<div class="subcomment">
					<form [formGroup]="subcommentForm" class="commentform">
						<input formControlName="txt" type="text">
						<button (click)="writeSubcomment(comment)">
							<img src="assets/send.png">
						</button>
					</form>
				</div> -->
			</div>
		</li>
	</ul>
	<br>
</ion-content>

<ion-footer>

	<form [formGroup]="commentForm" class="footerform">
		<input formControlName="txt" type="text">
		<button (click)="writeComment()" style="float:right">
			게시
		</button>

	</form>

</ion-footer>